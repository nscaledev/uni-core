// Package openapi provides primitives to interact with the openapi HTTP API.
//
// Code generated by github.com/deepmap/oapi-codegen version v1.16.2 DO NOT EDIT.
package openapi

import (
	"bytes"
	"compress/gzip"
	"encoding/base64"
	"fmt"
	"net/url"
	"path"
	"strings"

	"github.com/getkin/kin-openapi/openapi3"
)

// Base64 encoded, gzipped, json marshaled Swagger object
var swaggerSpec = []string{

	"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",
}

// GetSwagger returns the content of the embedded swagger specification file
// or error if failed to decode
func decodeSpec() ([]byte, error) {
	zipped, err := base64.StdEncoding.DecodeString(strings.Join(swaggerSpec, ""))
	if err != nil {
		return nil, fmt.Errorf("error base64 decoding spec: %w", err)
	}
	zr, err := gzip.NewReader(bytes.NewReader(zipped))
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}
	var buf bytes.Buffer
	_, err = buf.ReadFrom(zr)
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}

	return buf.Bytes(), nil
}

var rawSpec = decodeSpecCached()

// a naive cached of a decoded swagger spec
func decodeSpecCached() func() ([]byte, error) {
	data, err := decodeSpec()
	return func() ([]byte, error) {
		return data, err
	}
}

// Constructs a synthetic filesystem for resolving external references when loading openapi specifications.
func PathToRawSpec(pathToFile string) map[string]func() ([]byte, error) {
	res := make(map[string]func() ([]byte, error))
	if len(pathToFile) > 0 {
		res[pathToFile] = rawSpec
	}

	return res
}

// GetSwagger returns the Swagger specification corresponding to the generated code
// in this file. The external references of Swagger specification are resolved.
// The logic of resolving external references is tightly connected to "import-mapping" feature.
// Externally referenced files must be embedded in the corresponding golang packages.
// Urls can be supported but this task was out of the scope.
func GetSwagger() (swagger *openapi3.T, err error) {
	resolvePath := PathToRawSpec("")

	loader := openapi3.NewLoader()
	loader.IsExternalRefsAllowed = true
	loader.ReadFromURIFunc = func(loader *openapi3.Loader, url *url.URL) ([]byte, error) {
		pathToFile := url.String()
		pathToFile = path.Clean(pathToFile)
		getSpec, ok := resolvePath[pathToFile]
		if !ok {
			err1 := fmt.Errorf("path not found: %s", pathToFile)
			return nil, err1
		}
		return getSpec()
	}
	var specData []byte
	specData, err = rawSpec()
	if err != nil {
		return
	}
	swagger, err = loader.LoadFromData(specData)
	if err != nil {
		return
	}
	return
}
