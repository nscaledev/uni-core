name: Claude Code Review

on:
  pull_request:
    types: [opened, ready_for_review]

jobs:
  claude-review:
    if: |
      github.event.pull_request.author_association == 'OWNER' ||
      github.event.pull_request.author_association == 'MEMBER' ||
      github.event.pull_request.author_association == 'COLLABORATOR' ||
      github.event.pull_request.author_association == 'CONTRIBUTOR'

    uses: nscaledev/uni/.github/workflows/claude-code-review.yaml@main
    secrets:
      ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}

    permissions:
      actions: read
      contents: read
      pull-requests: read
      issues: read
      id-token: write
